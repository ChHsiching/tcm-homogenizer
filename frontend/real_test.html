<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœŸå®åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div id="login-container" class="login-container">
        <div class="login-box">
            <h2>ä¸­è¯å¤šç»„åˆ†å‡åŒ–åˆ†æå®¢æˆ·ç«¯</h2>
            <div id="first-run-message" class="first-run-message" style="display: none;">
                <p>é¦–æ¬¡å¯åŠ¨ï¼Œè¯·åˆ›å»ºç®¡ç†å‘˜è´¦å·</p>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">ç”¨æˆ·å</label>
                    <input type="text" id="username" name="username" value="admin" required>
                </div>
                <div class="form-group">
                    <label for="password">å¯†ç </label>
                    <input type="password" id="password" name="password" value="admin123" required>
                </div>
                <div class="form-group">
                    <button type="submit" id="login-btn">ç™»å½•</button>
                </div>
            </form>
            <div id="login-error" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <!-- ä¸»åº”ç”¨ç•Œé¢ -->
    <div id="main-container" class="main-container" style="display: none;">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="header">
            <div class="header-left">
                <h1>ä¸­è¯å¤šç»„åˆ†å‡åŒ–åˆ†æå®¢æˆ·ç«¯</h1>
            </div>
            <div class="header-right">
                <span id="user-info" class="user-info"></span>
                <button id="logout-btn" class="btn-secondary">é€€å‡ºç™»å½•</button>
            </div>
        </header>

        <!-- å¯¼èˆªèœå• -->
        <nav class="nav-menu">
            <button class="nav-btn active" data-tab="home">é¦–é¡µ</button>
            <button class="nav-btn" data-tab="regression">ç¬¦å·å›å½’</button>
            <button class="nav-btn" data-tab="monte-carlo">è’™ç‰¹å¡ç½—åˆ†æ</button>
            <button class="nav-btn admin-only" data-tab="data-management">æ•°æ®ç®¡ç†</button>
            <button class="nav-btn admin-only" data-tab="user-management">ç”¨æˆ·ç®¡ç†</button>
            <button class="nav-btn" data-tab="settings">è®¾ç½®</button>
        </nav>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- é¦–é¡µ -->
            <div id="home" class="tab-content active">
                <h2>æ¬¢è¿ä½¿ç”¨ä¸­è¯å¤šç»„åˆ†å‡åŒ–åˆ†æå®¢æˆ·ç«¯</h2>
                <div class="welcome-content">
                    <p>æœ¬ç³»ç»Ÿæä¾›ä¸­è¯å¤šç»„åˆ†é…æ¯”åˆ†æåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p>
                    <ul>
                        <li><strong>ç¬¦å·å›å½’åˆ†æ</strong>ï¼šé€šè¿‡é—ä¼ ç®—æ³•å‘ç°æ•°æ®ä¸­çš„æ•°å­¦å…³ç³»</li>
                        <li><strong>è’™ç‰¹å¡ç½—åˆ†æ</strong>ï¼šæ¨¡æ‹Ÿä¸åŒé…æ¯”ç»„åˆçš„è¯æ•ˆè¡¨ç°</li>
                        <li><strong>æ•°æ®ç®¡ç†</strong>ï¼šä¸Šä¼ ã€ç®¡ç†å’Œå¯¼å‡ºåˆ†ææ•°æ®</li>
                        <li><strong>ç”¨æˆ·ç®¡ç†</strong>ï¼šç®¡ç†ç³»ç»Ÿç”¨æˆ·å’Œæƒé™</li>
                    </ul>
                    <div class="status-info">
                        <p><strong>åç«¯çŠ¶æ€</strong>ï¼š<span id="connection-status">æ£€æŸ¥ä¸­...</span></p>
                        <p><strong>å½“å‰ç”¨æˆ·</strong>ï¼š<span id="current-user">æœªç™»å½•</span></p>
                        <p><strong>ç”¨æˆ·è§’è‰²</strong>ï¼š<span id="user-role">æœªçŸ¥</span></p>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·ç®¡ç† -->
            <div id="user-management" class="tab-content">
                <h2>ç”¨æˆ·ç®¡ç†</h2>
                <div class="user-section">
                    <div class="user-actions">
                        <h3>ç”¨æˆ·æ“ä½œ</h3>
                        <button id="add-user-btn" class="btn-primary">æ·»åŠ ç”¨æˆ·</button>
                        <button id="refresh-users-btn" class="btn-secondary">åˆ·æ–°åˆ—è¡¨</button>
                    </div>
                    <div class="user-list">
                        <h3>ç”¨æˆ·åˆ—è¡¨</h3>
                        <div id="users-table" class="data-table">
                            <p>åŠ è½½ä¸­...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- çŠ¶æ€æ  -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="connection-status-footer">åç«¯æœåŠ¡ï¼šæ£€æŸ¥ä¸­...</span>
            </div>
            <div class="status-right">
                <span id="current-time">2025-08-03 20:45:00</span>
            </div>
        </footer>
    </div>

    <!-- åŠ è½½é®ç½© -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loading-text">æ­£åœ¨å¤„ç†...</p>
        </div>
    </div>

    <!-- é€šçŸ¥å®¹å™¨ -->
    <div id="notification-container" class="notification-container"></div>

    <!-- æ¨¡æ€æ¡† -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">æ ‡é¢˜</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- æ¨¡æ€æ¡†å†…å®¹ -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="modal-cancel">å–æ¶ˆ</button>
                <button class="btn-primary" id="modal-confirm">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <script src="scripts/auth.js"></script>
    <script src="scripts/renderer.js"></script>
    
    <script>
        // é¢å¤–çš„è°ƒè¯•ä¿¡æ¯
        console.log('ğŸ”§ çœŸå®æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        
        // ç›‘å¬é¡µé¢åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ DOMåŠ è½½å®Œæˆ');
            
            // æ£€æŸ¥è®¤è¯ç®¡ç†å™¨
            if (typeof authManager !== 'undefined') {
                console.log('âœ… è®¤è¯ç®¡ç†å™¨å·²åŠ è½½');
            } else {
                console.error('âŒ è®¤è¯ç®¡ç†å™¨æœªåŠ è½½');
            }
            
            // æ£€æŸ¥æ¸²æŸ“å™¨
            if (typeof switchTab !== 'undefined') {
                console.log('âœ… æ¸²æŸ“å™¨å·²åŠ è½½');
            } else {
                console.error('âŒ æ¸²æŸ“å™¨æœªåŠ è½½');
            }
        });
        
        // ç›‘å¬è®¤è¯çŠ¶æ€å˜åŒ–
        const originalUpdateUserInfo = authManager.updateUserInfo;
        authManager.updateUserInfo = function() {
            console.log('ğŸ” ç”¨æˆ·ä¿¡æ¯æ›´æ–°:', this.currentUser);
            originalUpdateUserInfo.call(this);
        };
        
        // ç›‘å¬å¯¼èˆªå¯è§æ€§å˜åŒ–
        const originalUpdateNavigationVisibility = authManager.updateNavigationVisibility;
        authManager.updateNavigationVisibility = function() {
            console.log('ğŸ” å¯¼èˆªå¯è§æ€§æ›´æ–°');
            originalUpdateNavigationVisibility.call(this);
        };
    </script>
</body>
</html> 